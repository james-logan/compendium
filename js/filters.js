'use strict';

angular.module('compendiumPrime').filter('percentage', function () {
  return function (obj) {
    if (obj) {
      Object.keys(obj).forEach(function (key) {
        obj[key].percentage = Math.round(obj[key].page * 100 / obj[key].total);
        if (isNaN(obj[key].percentage)) {
          obj[key].percentage = 0;
        }
      });
      return obj;
    }
  };
}).filter('timeLine', function ($rootScope) {
  return function (obj) {
    $rootScope.timelineHeight = 50;
    if (obj) {
      var cat = Object.keys(obj).map(function (key) {
        return obj[key];
      }).sort(function (a, b) {
        var dateA = new Date(a.date);
        var dateB = new Date(b.date);
        return dateB.getTime() - dateA.getTime();
      });
      cat.forEach(function (book, i, array) {
        var recentDate = new Date(array[0].date);
        var bookDate = new Date(book.date);
        book.topValue = 20 * (recentDate.getTime() - bookDate.getTime()) / (1000 * 60 * 60 * 24);
        if (i % 2 === 1) {
          book.floatValue = 'left';
          book.leftMargin = 0;
        } else {
          book.floatValue = 'right';
          book.leftMargin = 310;
        }
        cat.forEach(function (book) {
          book.date = new Date(book.date);
          book.date = book.date.toLocaleDateString();
        });
      });
      return cat;
    }
  };
}).filter('objToArr', function () {
  return function (obj) {
    if (obj) {
      return Object.keys(obj).map(function (key) {
        obj[key]._id = key;
        return obj[key];
      });
    }
  };
}).filter('sortLeader', function () {
  return function (arr) {
    if (arr) {
      return arr.sort(function (a, b) {
        return b.points - a.points;
      });
    }
  };
});
//# sourceMappingURL=data:application/json;base64,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LENBQUMsQ0FBQTtBQUNKLGFBQU8sR0FBRyxDQUFBO0tBQ1Q7R0FDRixDQUFBO0NBQ0YsQ0FBQyxDQUNELE1BQU0sQ0FBQyxVQUFVLEVBQUUsWUFBWTtBQUM5QixTQUFPLFVBQVUsR0FBRyxFQUFFO0FBQ3BCLFFBQUksR0FBRyxFQUFFO0FBQ1AsYUFBTyxNQUFNLENBQ1YsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUNULEdBQUcsQ0FBQyxVQUFVLEdBQUcsRUFBRTtBQUNsQixXQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztBQUNuQixlQUFPLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztPQUNqQixDQUFDLENBQUM7S0FDSjtHQUNGLENBQUE7Q0FDSixDQUFDLENBQ0QsTUFBTSxDQUFDLFlBQVksRUFBRSxZQUFZO0FBQ2hDLFNBQU8sVUFBVSxHQUFHLEVBQUU7QUFDcEIsUUFBSSxHQUFHLEVBQUU7QUFDUCxhQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxFQUFFO0FBQzlCLGVBQU8sQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFBO09BQzNCLENBQUMsQ0FBQTtLQUNIO0dBQ0YsQ0FBQTtDQUNGLENBQUMsQ0FBQSIsImZpbGUiOiJzcmMvanMvZmlsdGVycy5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXJcbiAgLm1vZHVsZSgnY29tcGVuZGl1bVByaW1lJylcbiAgLmZpbHRlcigncGVyY2VudGFnZScsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgaWYgKG9iaikge1xuICAgICAgT2JqZWN0LmtleXMob2JqKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgb2JqW2tleV0ucGVyY2VudGFnZSA9IE1hdGgucm91bmQob2JqW2tleV0ucGFnZSAqIDEwMCAvIG9ialtrZXldLnRvdGFsKVxuICAgICAgICBpZiAoaXNOYU4ob2JqW2tleV0ucGVyY2VudGFnZSkpIHtcbiAgICAgICAgICBvYmpba2V5XS5wZXJjZW50YWdlID0gMDtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiBvYmpcbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIC5maWx0ZXIoJ3RpbWVMaW5lJywgZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgJHJvb3RTY29wZS50aW1lbGluZUhlaWdodCA9IDUwO1xuICAgICAgaWYgKG9iaikge1xuICAgICAgICB2YXIgY2F0ID0gT2JqZWN0LmtleXMob2JqKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIHJldHVybiBvYmpba2V5XVxuICAgICAgICB9KS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgdmFyIGRhdGVBID0gbmV3IERhdGUoYS5kYXRlKVxuICAgICAgICAgIHZhciBkYXRlQiA9IG5ldyBEYXRlKGIuZGF0ZSlcbiAgICAgICAgICByZXR1cm4gZGF0ZUIuZ2V0VGltZSgpIC0gZGF0ZUEuZ2V0VGltZSgpXG4gICAgICAgIH0pXG4gICAgICAgIGNhdC5mb3JFYWNoKGZ1bmN0aW9uIChib29rLCBpLCBhcnJheSkge1xuICAgICAgICAgIHZhciByZWNlbnREYXRlID0gbmV3IERhdGUoYXJyYXlbMF0uZGF0ZSlcbiAgICAgICAgICB2YXIgYm9va0RhdGUgPSBuZXcgRGF0ZShib29rLmRhdGUpXG4gICAgICAgICAgYm9vay50b3BWYWx1ZSA9ICgyMCAqIChyZWNlbnREYXRlLmdldFRpbWUoKSAtIGJvb2tEYXRlLmdldFRpbWUoKSkpLygxMDAwICogNjAgKiA2MCAqIDI0KVxuICAgICAgICAgIGlmIChpJTIgPT09IDEpIHtcbiAgICAgICAgICAgIGJvb2suZmxvYXRWYWx1ZSA9IFwibGVmdFwiO1xuICAgICAgICAgICAgYm9vay5sZWZ0TWFyZ2luID0gMDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYm9vay5mbG9hdFZhbHVlID0gXCJyaWdodFwiO1xuICAgICAgICAgICAgYm9vay5sZWZ0TWFyZ2luID0gMzEwO1xuICAgICAgICAgIH1cbiAgICAgICAgY2F0LmZvckVhY2goZnVuY3Rpb24gKGJvb2spIHtcbiAgICAgICAgICBib29rLmRhdGUgPSBuZXcgRGF0ZShib29rLmRhdGUpXG4gICAgICAgICAgYm9vay5kYXRlID0gYm9vay5kYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpXG4gICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICByZXR1cm4gY2F0XG4gICAgICB9XG4gICAgfVxuICB9KVxuICAuZmlsdGVyKCdvYmpUb0FycicsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgaWYgKG9iaikge1xuICAgICAgICByZXR1cm4gT2JqZWN0XG4gICAgICAgICAgLmtleXMob2JqKVxuICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgb2JqW2tleV0uX2lkID0ga2V5O1xuICAgICAgICAgICAgcmV0dXJuIG9ialtrZXldO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gIH0pXG4gIC5maWx0ZXIoJ3NvcnRMZWFkZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcnIpIHtcbiAgICAgIGlmIChhcnIpIHtcbiAgICAgICAgcmV0dXJuIGFyci5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgcmV0dXJuIGIucG9pbnRzIC0gYS5wb2ludHNcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gIH0pXG4iXX0=
