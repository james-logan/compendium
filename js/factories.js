'use strict';

angular.module('compendiumPrime').factory('Auth', function ($http, $rootScope, $location, STORAGE_URL) {
  var fb = new Firebase(STORAGE_URL);
  return {
    register: function register(loginObj, cb) {
      fb.createUser(loginObj, function (err, authData) {
        if (err) {
          console.log(err);
        } else if (cb) {
          cb(authData);
        }
      });
    },
    login: function login(loginObj, cb) {
      fb.authWithPassword(loginObj, function (err, authData) {
        if (err) {
          console.log('err');
        } else {
          $rootScope.auth = authData;
          if (cb) {
            cb();
          }
        }
      });
    },
    logout: function logout(cb) {
      fb.unauth(function () {
        $rootScope.auth = null;
        cb();
      });
    },
    requireLogin: function requireLogin() {
      $rootScope.auth = fb.getAuth();
      if (!fb.getAuth()) {
        $location.path('/login');
      }
    }
  };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9qcy9mYWN0b3JpZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQ0osTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQ3pCLE9BQU8sQ0FBQyxNQUFNLEVBQUUsVUFBVSxLQUFLLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUU7QUFDcEUsTUFBSSxFQUFFLEdBQUcsSUFBSSxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDbkMsU0FBTztBQUNMLFlBQVEsRUFBRSxrQkFBVSxRQUFRLEVBQUUsRUFBRSxFQUFFO0FBQ2hDLFFBQUUsQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLFVBQVUsR0FBRyxFQUFFLFFBQVEsRUFBRTtBQUMvQyxZQUFJLEdBQUcsRUFBRTtBQUNQLGlCQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1NBQ2pCLE1BQU0sSUFBSSxFQUFFLEVBQUU7QUFDYixZQUFFLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDZDtPQUNGLENBQUMsQ0FBQTtLQUNIO0FBQ0QsU0FBSyxFQUFFLGVBQVUsUUFBUSxFQUFFLEVBQUUsRUFBRTtBQUM3QixRQUFFLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLFVBQVUsR0FBRyxFQUFFLFFBQVEsRUFBRTtBQUNyRCxZQUFJLEdBQUcsRUFBRTtBQUNQLGlCQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFBO1NBQ25CLE1BQU07QUFDTCxvQkFBVSxDQUFDLElBQUksR0FBRyxRQUFRLENBQUM7QUFDM0IsY0FBSSxFQUFFLEVBQUU7QUFDTixjQUFFLEVBQUUsQ0FBQztXQUNOO1NBQ0Y7T0FDRixDQUFDLENBQUE7S0FDSDtBQUNELFVBQU0sRUFBRSxnQkFBVSxFQUFFLEVBQUU7QUFDcEIsUUFBRSxDQUFDLE1BQU0sQ0FBQyxZQUFZO0FBQ3BCLGtCQUFVLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztBQUN2QixVQUFFLEVBQUUsQ0FBQztPQUNOLENBQUMsQ0FBQztLQUNKO0FBQ0QsZ0JBQVksRUFBRSx3QkFBWTtBQUN4QixnQkFBVSxDQUFDLElBQUksR0FBRyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDL0IsVUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRTtBQUNqQixpQkFBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztPQUMxQjtLQUNGO0dBQ0YsQ0FBQTtDQUNGLENBQUMsQ0FBQSIsImZpbGUiOiJzcmMvanMvZmFjdG9yaWVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhclxuICAubW9kdWxlKCdjb21wZW5kaXVtUHJpbWUnKVxuICAuZmFjdG9yeSgnQXV0aCcsIGZ1bmN0aW9uICgkaHR0cCwgJHJvb3RTY29wZSwgJGxvY2F0aW9uLCBTVE9SQUdFX1VSTCkge1xuICAgIHZhciBmYiA9IG5ldyBGaXJlYmFzZShTVE9SQUdFX1VSTCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlZ2lzdGVyOiBmdW5jdGlvbiAobG9naW5PYmosIGNiKSB7XG4gICAgICAgIGZiLmNyZWF0ZVVzZXIobG9naW5PYmosIGZ1bmN0aW9uIChlcnIsIGF1dGhEYXRhKSB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICAgIH0gZWxzZSBpZiAoY2IpIHtcbiAgICAgICAgICAgIGNiKGF1dGhEYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgICAgbG9naW46IGZ1bmN0aW9uIChsb2dpbk9iaiwgY2IpIHtcbiAgICAgICAgZmIuYXV0aFdpdGhQYXNzd29yZChsb2dpbk9iaiwgZnVuY3Rpb24gKGVyciwgYXV0aERhdGEpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyJylcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHJvb3RTY29wZS5hdXRoID0gYXV0aERhdGE7XG4gICAgICAgICAgICBpZiAoY2IpIHtcbiAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgICAgbG9nb3V0OiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgZmIudW5hdXRoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkcm9vdFNjb3BlLmF1dGggPSBudWxsO1xuICAgICAgICAgIGNiKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIHJlcXVpcmVMb2dpbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAkcm9vdFNjb3BlLmF1dGggPSBmYi5nZXRBdXRoKCk7XG4gICAgICAgIGlmICghZmIuZ2V0QXV0aCgpKSB7XG4gICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuIl19
